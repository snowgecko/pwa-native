<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width minimum-scale=1.0 maximum-scale=1.0 user-scalable=no" />
		<title>Content Pages</title>
		<link rel="shortcut icon" type="image/jpg" href="./favicon.ico"/>

		<link type="text/css" rel="stylesheet" href="./css/style.css" />
		<link type="text/css" rel="stylesheet" href="./css/mmenu-light.css" />
		<link type="text/css" rel="stylesheet" href="./css/pages.css" />
		
		<link rel="manifest" href="./manifest.json">
		<!--class declaration--> 
  		<script src="./js/cPage.js" ></script>
  		<script src="./js/cMenu.js" ></script>
		<!--include module for editor--> 
	</head>
	<body>
		<div id="page">
			<div class="header" id="header">
				<!--//-->
				<a href="#menu"><span></span></a>Demo

				<nav id="menu" class="mm">
				<span>Search  <input type="search" name="searchbox"/></span>
					<ul><!--https://snowgecko.github.io/pwa-native/pages?name=final-->
						<li class="Selected"><a href="./">Home</a></li>
						<div id="html_menu">
						</div>	
<!-- can use prevent default to only click through (change page if javascript is turned off)-->
<!-- then update page contents and url dynamically-->
<!-- and set up the menu so that it expands to the right point based on url -->

<li><span><a href="/pages.html?id=1">Physiology</a></span>
	<ul><li><a href="/pages.html?id=1">sub physiology</a></li></ul></li><li><span>Physics</span></li>
<li><span>Pharmacology</span>
	<ul><li>sub Pharmacology 5</li>
	<li>sub Pharmacology 6</li>
	</ul>
</li>


						<!--fixed menu item-->
						<li><span>About us</span>
							<ul>
								<li><a class="content" href="#about/history">History</a></li>
								<li><span>The team</span>
									<ul>
										<li><a class="content" href="/pages.html?id=1">Management</a></li>
										<li><a class="content" href="pages.html?id=2">Sales</a></li>
										<li><a class="content" href="pages.html?id=3">Development</a></li>
									</ul>
								</li>
								<li><a class="content" href="#about/address">Our address</a></li>
							</ul>
						</li>
						<li><a class="content"href="#contact">Contact</a></li>
					</ul>
				</nav>
				<div id="submenu"></div>
			</div>
			<!--//end of header-->


			<!--change content according to passed value-->
			<div class="content main">
				<h3>Title</h3><br />
				<p id="content">
				<div class="element"></div>
					Try to extend the cotnent across the page so that when you click on it - it closes the menu... blah blah 
					Try to extend the cotnent across the page so that when you click on it - it closes the menu... blah blah 
					Try to extend the cotnent across the page so that when you click on it - it closes the menu... blah blah 
					Try to extend the cotnent across the page so that when you click on it - it closes the menu... blah blah 
				</p>
			</div>
		</div>

		<script src="./js/mmenu-light.js"></script>
		<script src="./js/mmenu-page.js"></script>		
	

<!--CLASS SETTINGS-->
<script>
	// creating a Page object
	var urlParams = new URLSearchParams(window.location.search);
	//class declaration for Menu
	//remember if already loaded into IndexedDB then use that 
	let primary_nav = new Menu(urlParams.get('id'));
	primary_nav.menuJSON();
	//not filled as async .......
	//console.log(primary_nav.menuArray);
	//not filled as async .......


	//class declaration for Page
	//page1 is an instance of Page class
	let page1 = new Page(urlParams.get('name'));
	page1.setColor();

</script>


<!--my custom scripting--> 
<script>


//populate();
//OLD VERSION OF FETCH AND RESPONSE - NOW JUST NEED response.json and .then which is async already
async function populate() {
  const requestURL = './assets/testdata.json';
  const request = new Request(requestURL);
  const response = await fetch(request);
  const menuData = await response.json();
  //populateMenu(menuData);

  const requestPageURL = './assets/testpagedata.json';
  const requestPage = new Request(requestPageURL);
  const responsePage = await fetch(requestPage);
  const pageData = await responsePage.json();
  populatePage(pageData);
}

//I do not need to do this with the menu as I can populate it from the indexedDB
//so I just need to call cidb.fill?
function populateMenu(obj) {
	
  	const submenu = document.getElementById('submenu');
	//console.log(obj['pageName']); // eg Physiology - root 
 	menuString = "";
        Object.entries(obj).forEach(([key, value]) => {
			menuString += key + " " ;			 
            console.log(key);
			menuString += value + "<br/>";
            console.log(value);
        });
        console.log('-------------------');
  submenu.textContent = menuString;
  //console.log(menuString);
}
function populatePage(obj){
	const myPara = document.getElementById("content");
	myPara.textContent = `Hometown: ${obj['homeTown']} // Formed: ${obj['formed']}`;
  	//header.appendChild(myPara);

}

</script>

</body>
</html>
