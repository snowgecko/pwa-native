<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width minimum-scale=1.0 maximum-scale=1.0 user-scalable=no" />
		<title>Content Pages</title>
		<link rel="shortcut icon" type="image/jpg" href="./favicon.ico"/>

		<link type="text/css" rel="stylesheet" href="./css/style.css" />
		<link type="text/css" rel="stylesheet" href="./css/pages.css" />

		<link type="text/css" rel="stylesheet" href="./css/menu.css" />
		
		<link rel="manifest" href="./manifest.json">
		<!--class declaration--> 
  		<script src="./js/cPage.js" ></script>
  		<script src="./js/cMenu.js" ></script>

		<!--include module for editor--> 
	</head>
	<body>
		<div id="page">
			<div class="header" id="header">
				<!--//-->
				<div class="text"><a href="#menu" class="menulines"><span></span></a><div id="section_title">FRCA Primary</div></div>
				<!--//-->
				<div id="mySidenav" class="sidenav">
					<input type="search" name="searchbox" id="searchbox"/>
					<div id="menu">
				      <!--<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>-->
				      	<ul> 
							<li class="Selected"><a href="./">Home</a></li>
							<!--onclick="javascript:toggleMenu(1)"-->
							<div id="html_menu">
								<!--*****WILL BE POPULATED DYNAMICALLY JS******-->
							</div>
							<li><a href="#">About</a></li>
				      		<li><a href="#">Contact</a></li>
						</ul>
					</div>
				</div>
			</div>
			<div class="content main" id="content_main">
				<h3>Title</h3><br />
				<p id="content">
				  <!--<span style="font-size:30px;cursor:pointer" onclick="openNav()">&#9776;</span><h2 class="display_inline">Sidenav Push Example</h2>-->
						<div class="element"></div>
						Try to extend the cotnent across the page so that when you click on it - it closes the menu... blah blah 
						Try to extend the cotnent across the page so that when you click on it - it closes the menu... blah blah 
						Try to extend the cotnent across the page so that when you click on it - it closes the menu... blah blah 
						Try to extend the cotnent across the page so that when you click on it - it closes the menu... blah blah 
					</p>
			</div>
		</div>
<!--NOT USED ANYMORE
<script src="./js/mmenu-light.js"></script>
<script src="./js/mmenu-page.js"></script>		
-->
<!--DOES NOT WORK FOR SUB_SUB NAVIGATION ?ARIA issue-->
<script src="./js/cMenu-page.js"></script>		
<!--changed the params when  menuItem_click(evt) is run -->
<!--CLASS SETTINGS-->
<script>
	// creating a Page object
	var urlParams = new URLSearchParams(window.location.search);

	//class declaration for Menu
	//this url_id will only be from the original page call//
	url_id = urlParams.get('id');
	//set navigation data based on id... need also to get page_id from menu[id].pageid
	//to pass to page object
	let primary_nav = new Menu(url_id);
	primary_nav.id = url_id; //using setter
	console.log ("primary_nav.sectionid="+ primary_nav.sectionid);
	primary_nav.menuJSON();

	/*This function is called from each Menu click*/
	/** called from cMenu-page.js***/
	function updatePage(_pageid, _sectionid){
		console.log("updatePage _pageid called from Menu click=" + _pageid);
		let page1 = new Page(_pageid);
		//page1.id = url_id - would call the setter, but declared when declaring the class.
		page1.pageContent(_pageid, _sectionid);		
		//call data1000.json - ie, call the pageid file from pages folder.
		
	}
	
	function expand_collapse(evt){
		//var coll = document.getElementsByClassName("collapsible");
		//var i;
		//for (i = 0; i < coll.length; i++) {
		//  coll[i].addEventListener("click", function() {
			//var parElem = evt.target.parentElement;
		    //alert(evt.target);
			var event_Button = evt.target;
			event_Button.classList.toggle("active");
//event_Button.style.backgroundColor = "red"; //only updates on click
		    var content = event_Button.nextElementSibling;
		    if (content.style.maxHeight){
		      content.style.maxHeight = null;
		    } else {
		      content.style.maxHeight = content.scrollHeight + "px";
		    } 
		  //});
		//}
		
	}

	//primary_nav.menuID(url_id);
	//primary_nav.setColor();
	//not filled as async .......
	//console.log(primary_nav.menuArray);
	//not filled as async .......
	//class declaration for Page
	//page1 is an instance of Page class



function toggleMenu(p_pageid){
	console.log (p_pageid);
}
//populate();
//OLD VERSION OF FETCH AND RESPONSE - NOW JUST NEED response.json and .then which is async already
async function populate() {
  const requestURL = './assets/testdata.json';
  const request = new Request(requestURL);
  const response = await fetch(request);
  const menuData = await response.json();
  //populateMenu(menuData);

  const requestPageURL = './assets/testpagedata.json';
  const requestPage = new Request(requestPageURL);
  const responsePage = await fetch(requestPage);
  const pageData = await responsePage.json();
  populatePage(pageData);
}

//I do not need to do this with the menu as I can populate it from the indexedDB
//so I just need to call cidb.fill?
function populateMenu(obj) {
	
  	const submenu = document.getElementById('submenu');
	//console.log(obj['pageName']); // eg Physiology - root 
 	menuString = "";
        Object.entries(obj).forEach(([key, value]) => {
			menuString += key + " " ;			 
            console.log(key);
			menuString += value + "<br/>";
            console.log(value);
        });
        console.log('-------------------');
  submenu.textContent = menuString;
  //console.log(menuString);
}
function populatePage(obj){
	const myPara = document.getElementById("content");
	myPara.textContent = `Hometown: ${obj['homeTown']} // Formed: ${obj['formed']}`;
  	//header.appendChild(myPara);

}

</script>

</body>
</html>
